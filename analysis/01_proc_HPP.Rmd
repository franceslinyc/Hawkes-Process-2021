---
title: "01_proc_HPP"
author: "Frances Lin"
date: "4/15/2021"
output: pdf_document
---

```{r warning=FALSE, message=FALSE}
library(tidyverse)
library(ggplot2)
```

```{r}
set.seed(1) # for reproducibility

t_max <- 10 
t <- 0 

lmbda <- 10

X <- numeric(0) # vector of t

while(t <= t_max){
  u       <- runif(1)
  t       <-  t - log(u)/lmbda                # t ~ exp(1/lambda)
  if(t < t_max) {
    X <- c(X,t)                               # update index 
  }
}
```

```{r}
length(X)
```

```{r}
df_HPP = tibble(
  x = X, 
  y = 0:(length(X) - 1)
)

p_HPP <- ggplot(data=df_HPP, mapping=aes(x=x, y=y)) +
  geom_step() + 
  labs(title = "Homogeneous Poisson Process (lambda = 10)", 
       x = "t", 
       y = "N(t)")
#p_HPP
```

```{r}
# Plot time plot
df_HPP <- df_HPP %>% add_column(
  t_fix = rep(2, length(df_HPP$x))
) 

p_HPP_time <- ggplot(data=df_HPP, mapping=aes(x=x, y=t_fix)) +
  geom_point(size=0.5) + 
  ylim(c(1,3)) +
  labs(title = "Corresponding Inter-Arrivial Times", 
       x = "t", 
       y = "y-axis has no meaning") 
#p_HPP_time
```

```{r}
p_HPP_hist <- ggplot(data=df_HPP, mapping=aes(x=x)) + 
  geom_histogram(bins = 11, color = "white") + 

  labs(x = "t", 
       y = "lambda")
p_HPP_hist 
```

```{r}
require(gridExtra)
grid.arrange(p_HPP, p_HPP_time)
```



