---
title: |
  | \LARGE Prequel to Hawkes Processes: \Large An Overview of Spatial, Temporal and Spatio-Temporal Point Processes and Some Simulations
author: |
  |
  |
  | \Large Frances Lin 
  | \vspace{0.2cm} \large Master's Presentation 
date: | 
  | \Large June 2020
output: 
  beamer_presentation:
    theme: "boxes"
    colortheme: "sidebartab"
biblio-style: apalike 
incremental: TRUE
header-includes:
  - \usepackage{makecell}
  - \usepackage{booktabs}
  - \usepackage{adjustbox}
  - \addfootbox{normal text}{\hfill\insertframenumber\quad}
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```

```{r warning=FALSE, message=FALSE}
library(spatstat)
library(tidyverse)
library(here)
```

## Background: Hawkes Processes 

Events such as earthquake epicenters, crime patterns, forest wildfires, financial transcations, etc. often exhibit triggering and/or clustering behavior. 

Hawkes processes, also known as self-exciting point processes (SEPP), can be used to capture events with such behavior.

## Background: Characteristics

The defining characteristic of SEPP is that it 'self-excites'. Given the history of events, more recent events also exert more influence on the rate at which events occur. 

For example, 

- an earthquake that causes aftershocks, 

- a gang rivalry that triggers retaliations following the gang crime. 

In both cases, the initial event can continue to spawn 'offspring' events and the 'offspring' events can spawn 'offspring' events of their own, but the spawns fade out eventually.

## Background: Applications

SEPP find applications in a wide variety of fields since they have been used to model events such as

- earthquake epicenters (Ogata, 1988, 1998),

- crime patterns (Mohler et al., 2011; Reinhart & Greenhouse, 2018), 

- forest wildfires (Peng, et al., 2005), 

- insurance claims (Stabile et al., 2010), 

- financial transcations (Bauwens and Hautsch, 2009; Embrechts et al., 2011; Bacry et al., 2015), 

- social network events (Zhao et al., 2015; Rizoiu et al., 2017), 

- neuron activities (Johnson, 1996; Gerhard et al., 2017), and 

- disease spread or transmission (Meyer et al., 2012; Meyer & Held, 2014).

## Background and Objectives

SEPP have not gained much attention from the machine learning communities even with their predictive capabilities. Some relevant point processes are often left out from graduate-level, introductory spatial statistics and stochastic processes courses.

**Project Goal:** Give an overview of various types of point processes so that interested readers have the background knowledge to comprehend existing SEPP literature as well as explore the field further.

## Outline

Give introductions, definitions, properties, and applications of

1. Counting Process

2. HPP (Homogeneous Poisson Process)

3. NPP (Nonhomogeneous Poisson Process)

4. **Cox and Cluster Processes**

5. **Hawkes Process**

6. **Spatio-Temporal Self-Exciting Point Process**

Wrap up with Recent Advancements and Future Work of SEPP & Thinning Algorithm (if have time)

## Counting Process

A counting process counts the occurrence (or number) of events over time, space, space-time, etc. 

For example, 

- the arrival time of customers at a super market for a set of points in time, 

- the location of trees occuring at a point in space over some bounded region of the space,

- earthquake's epicenter as a point in space and time, 

as long as we are able to count them. 

## Counting Process

![](../results/plot_1D_Counting.png)

*Let $N(t)$ counts the number of events up to some time $t$, \textcolor{blue}{1.} $N(t)$ > 0, \textcolor{blue}{2.} $N(t)$ integer, \textcolor{blue}{3.} increasing function, and \textcolor{blue}{4.} $N(2) = 3$ and $N(4) = 4$.*

## HPP (Homogeneous Poisson Process)

HPP is one of the simplest yet most-widely used point processes (Baddeley et al., 2015). For example, 

- bus arrivals at a bus stop, 

- car accidents at a site,

- the document requests on a web server over time, etc.

HPPs are independent, stationary, and homogeneous. The distribution of the numbers of events, $N(t)$, depends only on the length of the interval and rate $=\lambda$. 

The defining characteristic of HPP is that $N(t)$ follow a Poisson distribution with a constant rate $\lambda$ (e.g. events over time).

## HPP ($\lambda = 10$)

![](../results/plot_1D_HPP.png)

*The cumulative number of points is growing at a constant linear rate. The histogram of rate appears roughly uniform. $N(3) \approx 30$ and $N(4) \approx 40$.*

## NPP (Nonhomogeneous Poisson Process)

Assuming that the rate in which points occur is constant is often not realistic in practice. For example, 

- the arrival rate of customers is higher during lunch time as compared to say, 2am, as in the supermarket example, 

- environmental factors such as temperature and rainfall affect the spatial distribution of the trees as in the trees in a forest example.

NPPs are independent but not stationary nor homogeneous. The distribution of $N(t)$ can change when shifted in $t$ and rate = $\lambda(t)$.

For HPP, $N(t)$ still follow a Poisson distribution but with an intensity function $\lambda(t)$ such that the intensity now varies with a function of time.

## A Motivating Example: HPP vs. NPP in 2D

![](../results/plot_2D_All.png){height=50%, width=50%}

Left: A realization of a HPP (rate = 100). HPP points appear uniformly distributed in area $|u|$. 

Right: A realization of a HPP (rate/intensity $= 400 x y$). NPP points appear to concentrate at the upper-right corner.

## Cox and Cluster Processes

## Cox vs. Matern Cluter in 2D

![](../results/plot_2D_All2.png){height=50%, width=50%}

## (Temporal) Hawkes Process

## Hawkes Process

![](/Users/franceslinyc/Hawkes-Process-2021/results/plot_1D_Hawkes.png)

## Spatio-temporal SEPP (Self-Exciting Point Process)

## Recent Advancements and Future Work of SEPP

Recent work has extended the use of SEPP to novel applications such as 

- mass shootings (Boyd & Molyneux, 2021), 

- COVID-19 transmission (Chiang et al., 2020), and 

- gang violence (Park et al., 2021). 

However, there is still much work to be done which include computational advances to ease the burden of applying the models to bigger data sets (Holbrook et al., 2021), residual and model diagnostics, methods that make the models more flexible and applicable, etc.

## Thinning Algorithm

Thinning algorithm is also called acceptance-rejection method. 

## Algorithm 2: Simulations of a Hawkes Process via Thinning Algorithm

\ \ Imput $\mu$, $\alpha$, $\beta$, $\lambda$, $t_{max}$

1. Simulate a HPP using Algorithm 1 (Appendix)

2. Create a $\lambda(t)$ function where the function $= \mu + \sum^{}_{i: T_i < t} \alpha e^ {-\beta x}$

3. Set $\lambda^*$ = apply the $\lambda(t)$ function to the HPP

4. Generate $u \sim U(0,1)$

5. **if** ($u < min( \frac{\lambda^*} {\lambda}, 1)$) where the accepting probability $= min( {\lambda^*} / {\lambda}, 1)$

6. \ | Keep the points

7. **else**

8. \ | "Thin" or reject the points and **return** $\{t_{k}\}_{k = 0, 1,... }$

## Thank you!

Prequel to Hawkes Processes: An Overview of Temporal and Spatio-Temporal Point Processes and Some Simulations

Frances Lin

MS student, Dept. of Statistics, Oregon State University

Report, code, etc. are available at 

GitHub: franceslinyc, [Hawkes-Process-2021](https://github.com/franceslinyc/Hawkes-Process-2021)

## Acknowledgments

I want to thank 

- James Molyneux for his constant support and encouragement while advising this Master's project, 

- Lisa Madsen & Charlotte Wickham for their willingness to co-advise as I press on for the PhD program here at OSU, 

- Sarah Emerson for both academic and nonacademic support that played major roles in my decision to pursue the PhD here, and 

- my cohort, our previous cohort and other PhD students for reassuring us that we will make it too despite the ongoing challenges.

But no thanks for the COVID-19 pandemic, 2020 Oregon wildfires and the social unrest that sparked the Black Lives Matter & Stop Asian Hate movement.



